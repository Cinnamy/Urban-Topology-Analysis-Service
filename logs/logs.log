2022-10-12T14:37:26.571937+0000: INFO|	 POST /api/car/ { name : string, country : string, region : string } 200 OK
2022-10-12T14:37:26.571937+0000: INFO|	 POST /api/car/ { name : string, country : string, region : string } 200 OK
2022-10-12T14:37:39.021293+0000: INFO|	 GET /api/car/1/ 200 OK
2022-10-12T14:37:39.021293+0000: INFO|	 GET /api/car/1/ 200 OK
2022-10-12T14:37:59.143679+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (139906095884096):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f3e6c538b80>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f3e6a97d850>
    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'country': 'string', 'region': 'string', 'name': 'Санкт Петербург'}
    │      │       └ 'INSERT INTO city (country, region, name) VALUES (%(country)s, %(region)s, %(name)s) RETURNING city.id'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f3e690c9c70; closed: -1>

psycopg2.errors.StringDataRightTruncation: value too long for type character varying(10)



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 72, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f3e6d0639d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f3e6b98fdc0>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f3e6b98f8b0>
    └ <uvicorn.server.Server object at 0x7f3e6910f700>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f3e6b98f940>
           │       │   └ <uvicorn.server.Server object at 0x7f3e6910f700>
           │       └ <function run at 0x7f3e6cf68940>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f3e69148640>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f3e6c8c7040>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f3e6c8bef70>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f3e6c8c9af0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f3e6c900790>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f3e690ab130>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f3e6910f640>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f3e690ab130>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f3e690c62e0>
          └ <fastapi.applications.FastAPI object at 0x7f3e6910f640>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f3e6912a3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f3e690c62e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f3e6912a3a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7f3e6ba600d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f3e690c6250>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f3e690c61f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f3e690c6250>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f3e690b8520>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f3e690c61f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f3e6bb6c1f0>
          └ <fastapi.routing.APIRoute object at 0x7f3e690cd370>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f3e690bee50>
          └ <fastapi.routing.APIRoute object at 0x7f3e690cd370>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f3e687ddac0>
                     └ <function get_request_handler.<locals>.app at 0x7f3e690bedc0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f3e6bb5a0d0>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>, 'city_info': _BaseCity(country='string', region='string', n...
                 │         └ <function add_city at 0x7f3e690bed30>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f3e690cd3a0>

  File "/app/fastapi_service/main.py", line 59, in add_city
    city = await _services.create_city(city=city_info, db=db)
                 │         │                │             └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
                 │         │                └ _BaseCity(country='string', region='string', name='Санкт Петербург')
                 │         └ <function create_city at 0x7f3e691e0430>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 26, in create_city
    db.commit()
    │  └ <function Session.commit at 0x7f3e6aae5280>
    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
    │    │            └ <function SessionTransaction.commit at 0x7f3e6aae31f0>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdd90>
    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7f3e6aae3160>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdd90>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7f3e6aae7ee0>
    │    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdd90>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7f3e6aae80d0>
    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7f3e6aae3280>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7f3e6b870f70>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7f3e6aada8b0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f3e6902c040>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f3e6902c040>
    │   └ <function SaveUpdateAll.execute at 0x7f3e6aade1f0>
    └ SaveUpdateAll(mapped class City->city)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7f3e6aacb310>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7f3e6b8ee970>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 245, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x7f3e6aacb940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
             │          └ <function Connection._execute_20 at 0x7f3e6b041ee0>
             └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f3e6a97d850>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ({'name': 'Санкт Петербург', 'region': 'string', 'country': 'string'},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x7f3e687dd1c0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f3e6b041d30>
           └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f3e6b042040>
          └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f3e6b0421f0>
    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f3e6b870f70>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f3e6c538b80>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f3e6a97d850>
    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'country': 'string', 'region': 'string', 'name': 'Санкт Петербург'}
    │      │       └ 'INSERT INTO city (country, region, name) VALUES (%(country)s, %(region)s, %(name)s) RETURNING city.id'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f3e690c9c70; closed: -1>

sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(10)

[SQL: INSERT INTO city (country, region, name) VALUES (%(country)s, %(region)s, %(name)s) RETURNING city.id]
[parameters: {'country': 'string', 'region': 'string', 'name': 'Санкт Петербург'}]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
2022-10-12T14:37:59.143679+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (139906095884096):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f3e6c538b80>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f3e6a97d850>
    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'country': 'string', 'region': 'string', 'name': 'Санкт Петербург'}
    │      │       └ 'INSERT INTO city (country, region, name) VALUES (%(country)s, %(region)s, %(name)s) RETURNING city.id'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f3e690c9c70; closed: -1>

psycopg2.errors.StringDataRightTruncation: value too long for type character varying(10)



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 72, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f3e6d0639d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f3e6b98fdc0>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f3e6b98f8b0>
    └ <uvicorn.server.Server object at 0x7f3e6910f700>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f3e6b98f940>
           │       │   └ <uvicorn.server.Server object at 0x7f3e6910f700>
           │       └ <function run at 0x7f3e6cf68940>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f3e69148640>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f3e6c8c7040>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f3e6c8bef70>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f3e6c8c9af0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f3e6c900790>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f3e69061940>(<Future finis...7f3e69094c70>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f3e690ab130>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f3e6910f640>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f3e690ab130>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f3e690c62e0>
          └ <fastapi.applications.FastAPI object at 0x7f3e6910f640>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f3e6912a3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f3e690c62e0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f3e6912a3a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7f3e6ba600d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f3e690c6250>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f3e690c6280>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f3e690c61f0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f3e690c6250>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f3e690b8520>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f3e690c61f0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f3e6bb6c1f0>
          └ <fastapi.routing.APIRoute object at 0x7f3e690cd370>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f3e690be550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f3e690cdcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.20.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f3e690bee50>
          └ <fastapi.routing.APIRoute object at 0x7f3e690cd370>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f3e687ddac0>
                     └ <function get_request_handler.<locals>.app at 0x7f3e690bedc0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f3e6bb5a0d0>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>, 'city_info': _BaseCity(country='string', region='string', n...
                 │         └ <function add_city at 0x7f3e690bed30>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f3e690cd3a0>

  File "/app/fastapi_service/main.py", line 59, in add_city
    city = await _services.create_city(city=city_info, db=db)
                 │         │                │             └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
                 │         │                └ _BaseCity(country='string', region='string', name='Санкт Петербург')
                 │         └ <function create_city at 0x7f3e691e0430>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 26, in create_city
    db.commit()
    │  └ <function Session.commit at 0x7f3e6aae5280>
    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
    │    │            │               │    └ False
    │    │            │               └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
    │    │            └ <function SessionTransaction.commit at 0x7f3e6aae31f0>
    │    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdd90>
    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x7f3e6aae3160>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdd90>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x7f3e6aae7ee0>
    │    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdd90>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3386, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7f3e6aae80d0>
    └ <sqlalchemy.orm.session.Session object at 0x7f3e69094c70>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3526, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x7f3e6aae3280>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x7f3e690cdca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x7f3e6b870f70>
    └ <module 'sqlalchemy.util.compat' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 3486, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7f3e6aada8b0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f3e6902c040>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7f3e6902c040>
    │   └ <function SaveUpdateAll.execute at 0x7f3e6aade1f0>
    └ SaveUpdateAll(mapped class City->city)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7f3e6aacb310>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py'>
    │    └ <sqlalchemy.util._preloaded._ModuleRegistry object at 0x7f3e6b8ee970>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 245, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x7f3e6aacb940>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
             │          └ <function Connection._execute_20 at 0x7f3e6b041ee0>
             └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ {'compiled_cache': {(<sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f3e6a97d850>, ('0', <class 'sql...
           │    │     │             └ immutabledict({})
           │    │     └ ({'name': 'Санкт Петербург', 'region': 'string', 'country': 'string'},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x7f3e687dd1c0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f3e6b041d30>
           └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f3e6b042040>
          └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f3e6b0421f0>
    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f3e6b870f70>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f3e6c538b80>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f3e6a97d850>
    └ <sqlalchemy.engine.base.Connection object at 0x7f3e68810130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'country': 'string', 'region': 'string', 'name': 'Санкт Петербург'}
    │      │       └ 'INSERT INTO city (country, region, name) VALUES (%(country)s, %(region)s, %(name)s) RETURNING city.id'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f3e690c9c70; closed: -1>

sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(10)

[SQL: INSERT INTO city (country, region, name) VALUES (%(country)s, %(region)s, %(name)s) RETURNING city.id]
[parameters: {'country': 'string', 'region': 'string', 'name': 'Санкт Петербург'}]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
2022-10-12T14:39:16.904486+0000: INFO|	 POST /api/car/ { name : SPB, country : None, region : None } 200 OK
2022-10-12T14:39:16.904486+0000: INFO|	 POST /api/car/ { name : SPB, country : None, region : None } 200 OK
2022-10-12T14:39:56.108494+0000: INFO|	 GET /api/car/2/ 200 OK
2022-10-12T14:39:56.108494+0000: INFO|	 GET /api/car/2/ 200 OK
2022-10-12T14:43:26.347798+0000: INFO|	 GET /api/car/1/ 200 OK
2022-10-12T14:43:26.347798+0000: INFO|	 GET /api/car/1/ 200 OK
2022-10-12T16:22:30.124226+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc400; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec346e940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec346e940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34259a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34269d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34259a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec33d1790>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426940>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>, 'page': 0, 'per_page': 10}
                 │         └ <function get_cities at 0x7f8ec34268b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3425820>

  File "/app/fastapi_service/main.py", line 88, in get_cities
    cities = await _services.get_cities(page=page, per_page=per_page, db=db)
                   │         │               │              │            └ <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>
                   │         │               │              └ 10
                   │         │               └ 0
                   │         └ <function get_cities at 0x7f8ec353a670>
                   └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 31, in get_cities
    cities = db.query(_models.City).all()
             │  │     │       └ <class 'models.City'>
             │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
             │  └ <function Session.query at 0x7f8ec4e3fc10>
             └ <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2772, in all
    return self._iter().all()
           │    └ <function Query._iter at 0x7f8ec4e620d0>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec33d1190>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec33d1190>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec339f0a0>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec339f0a0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc400; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:22:30.124226+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc400; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec3383340>(<Future finis...7f8ec33837f0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec346e940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec346e940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34259a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec341ac10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec33d1fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34269d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34259a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec33d1790>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426940>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>, 'page': 0, 'per_page': 10}
                 │         └ <function get_cities at 0x7f8ec34268b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3425820>

  File "/app/fastapi_service/main.py", line 88, in get_cities
    cities = await _services.get_cities(page=page, per_page=per_page, db=db)
                   │         │               │              │            └ <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>
                   │         │               │              └ 10
                   │         │               └ 0
                   │         └ <function get_cities at 0x7f8ec353a670>
                   └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 31, in get_cities
    cities = db.query(_models.City).all()
             │  │     │       └ <class 'models.City'>
             │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
             │  └ <function Session.query at 0x7f8ec4e3fc10>
             └ <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2772, in all
    return self._iter().all()
           │    └ <function Query._iter at 0x7f8ec4e620d0>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec33d1190>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec33837f0>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec33d1190>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec339f0a0>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec339f0a0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a0d0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc400; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:24:32.752522+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 0, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec3379940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec3379940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34260d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec339f1c0>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>, 'city_id': 0}
                 │         └ <function get_city at 0x7f8ec341af70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3422d90>

  File "/app/fastapi_service/main.py", line 36, in get_city
    city = await _services.get_city(city_id=city_id, db=db)
                 │         │                │           └ <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>
                 │         │                └ 0
                 │         └ <function get_city at 0x7f8ec353a700>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 37, in get_city
    city = db.query(_models.City).filter(_models.City.id == city_id).first()
           │  │     │       │            │       │    │     └ 0
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd540>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec29258b0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec29251c0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec2925940>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec2925940>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 0, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 0, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:24:32.752522+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 0, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec2925130>(<Future finis...7f8ec33d1be0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec3379940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec3379940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec29255e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34260d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec339f1c0>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>, 'city_id': 0}
                 │         └ <function get_city at 0x7f8ec341af70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3422d90>

  File "/app/fastapi_service/main.py", line 36, in get_city
    city = await _services.get_city(city_id=city_id, db=db)
                 │         │                │           └ <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>
                 │         │                └ 0
                 │         └ <function get_city at 0x7f8ec353a700>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 37, in get_city
    city = db.query(_models.City).filter(_models.City.id == city_id).first()
           │  │     │       │            │       │    │     └ 0
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd540>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec29258b0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec33d1be0>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec29251c0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec2925940>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec2925940>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec2925a60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 0, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 0, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:24:39.146672+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 1, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bcb80; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34260d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec292ea90>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>, 'city_id': 1}
                 │         └ <function get_city at 0x7f8ec341af70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3422d90>

  File "/app/fastapi_service/main.py", line 36, in get_city
    city = await _services.get_city(city_id=city_id, db=db)
                 │         │                │           └ <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>
                 │         │                └ 1
                 │         └ <function get_city at 0x7f8ec353a700>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 37, in get_city
    city = db.query(_models.City).filter(_models.City.id == city_id).first()
           │  │     │       │            │       │    │     └ 1
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd540>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec292eb80>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec292eb50>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec292ee50>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec292ee50>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 1, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bcb80; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 1, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:24:39.146672+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 1, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bcb80; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292e310>(<Future finis...7f8ec2925070>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec292ea30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34260d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec292ea90>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>, 'city_id': 1}
                 │         └ <function get_city at 0x7f8ec341af70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3422d90>

  File "/app/fastapi_service/main.py", line 36, in get_city
    city = await _services.get_city(city_id=city_id, db=db)
                 │         │                │           └ <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>
                 │         │                └ 1
                 │         └ <function get_city at 0x7f8ec353a700>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 37, in get_city
    city = db.query(_models.City).filter(_models.City.id == city_id).first()
           │  │     │       │            │       │    │     └ 1
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd540>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec292eb80>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec2925070>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec292eb50>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec292ee50>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec292ee50>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec292eca0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 1, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bcb80; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 1, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:24:42.350883+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 2, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec2958ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec2958ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34260d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec29252b0>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>, 'city_id': 2}
                 │         └ <function get_city at 0x7f8ec341af70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3422d90>

  File "/app/fastapi_service/main.py", line 36, in get_city
    city = await _services.get_city(city_id=city_id, db=db)
                 │         │                │           └ <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>
                 │         │                └ 2
                 │         └ <function get_city at 0x7f8ec353a700>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 37, in get_city
    city = db.query(_models.City).filter(_models.City.id == city_id).first()
           │  │     │       │            │       │    │     └ 2
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd540>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec339a400>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec339abe0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec339ae80>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec339ae80>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 2, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 2, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:24:42.350883+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 2, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec292ee20>(<Future finis...7f8ec292ef70>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec2958ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec2958ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec2958c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec339f1c0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec34260d0>
          └ <fastapi.routing.APIRoute object at 0x7f8ec3422be0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec29252b0>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec3426040>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>, 'city_id': 2}
                 │         └ <function get_city at 0x7f8ec341af70>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec3422d90>

  File "/app/fastapi_service/main.py", line 36, in get_city
    city = await _services.get_city(city_id=city_id, db=db)
                 │         │                │           └ <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>
                 │         │                └ 2
                 │         └ <function get_city at 0x7f8ec353a700>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 37, in get_city
    city = db.query(_models.City).filter(_models.City.id == city_id).first()
           │  │     │       │            │       │    │     └ 2
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd540>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec339a400>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec292ef70>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec339abe0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec339ae80>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec339ae80>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec339a130>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 2, 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bc9a0; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 2, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:25:36.372502+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bce50; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae310>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7f8ec5dbc160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34223d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec3426550>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34223d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec28b8760>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec34264c0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>, 'city_info': _BaseCity(country='string', region='string', c...
                 │         └ <function add_city at 0x7f8ec3426430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec34223a0>

  File "/app/fastapi_service/main.py", line 58, in add_city
    city = await _services.get_city_by_name(db=db, city_name=city_info.city_name)
                 │         │                   │             │         └ 'string'
                 │         │                   │             └ _BaseCity(country='string', region='string', city_name='string')
                 │         │                   └ <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>
                 │         └ <function get_city_by_name at 0x7f8ec353a790>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 43, in get_city_by_name
    city = db.query(_models.City).filter(_models.City.city_name == city_name).first()
           │  │     │       │            │       │    │            └ 'string'
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd720>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec28b8820>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec552c070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec28b8e20>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec28b8e20>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bce50; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.city_name = %(city_name_1)s 
 LIMIT %(param_1)s]
[parameters: {'city_name_1': 'string', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:25:36.372502+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140251206727488):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bce50; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f8ec73bc9d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f8ec5cebe50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f8ec5ceb940>
    └ <uvicorn.server.Server object at 0x7f8ec33f7160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f8ec5ceb9d0>
           │       │   └ <uvicorn.server.Server object at 0x7f8ec33f7160>
           │       └ <function run at 0x7f8ec72bedc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ec34a3b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f8ec6c230d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8ec6c23040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8ec6c24b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8ec6c59820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f8ec28b88e0>(<Future finis...7f8ec29255b0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ec33f7f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
          └ <fastapi.applications.FastAPI object at 0x7f8ec342f1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae310>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8ec342ffa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8ec33ae310>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7f8ec5dbc160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f8ec342ff40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8ec342ff10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f8ec342f220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f8ec342feb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f8ec5ec6280>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34223d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f8ec33ae790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f8ec28b8c70>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8ec3426550>
          └ <fastapi.routing.APIRoute object at 0x7f8ec34223d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8ec28b8760>
                     └ <function get_request_handler.<locals>.app at 0x7f8ec34264c0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ec5eb6160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>, 'city_info': _BaseCity(country='string', region='string', c...
                 │         └ <function add_city at 0x7f8ec3426430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f8ec34223a0>

  File "/app/fastapi_service/main.py", line 58, in add_city
    city = await _services.get_city_by_name(db=db, city_name=city_info.city_name)
                 │         │                   │             │         └ 'string'
                 │         │                   │             └ _BaseCity(country='string', region='string', city_name='string')
                 │         │                   └ <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>
                 │         └ <function get_city_by_name at 0x7f8ec353a790>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 43, in get_city_by_name
    city = db.query(_models.City).filter(_models.City.city_name == city_name).first()
           │  │     │       │            │       │    │            └ 'string'
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7f8ec34dd720>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7f8ec4e3fc10>
           └ <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7f8ec4e5e550>
           └ <sqlalchemy.orm.query.Query object at 0x7f8ec28b8820>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f8ec4e3f5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f8ec29255b0>
             └ <sqlalchemy.orm.query.Query object at 0x7f8ec552c070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f8ec28b8e20>
             │    └ <function Connection._execute_20 at 0x7f8ec539df70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f8ec28b8e20>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f8ec539ddc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f8ec539e0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f8ec539e280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f8ec5bee040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f8ec6895c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f8ec4dce400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f8ec28c6070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f8ec33bce50; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.city_name = %(city_name_1)s 
 LIMIT %(param_1)s]
[parameters: {'city_name_1': 'string', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:28:50.801180+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (139739549534016):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f17a5642c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f17a3b7b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f17a2169400; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f17a61699d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f17a4a98e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f17a4a98940>
    └ <uvicorn.server.Server object at 0x7f17a21a4160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f17a4a989d0>
           │       │   └ <uvicorn.server.Server object at 0x7f17a21a4160>
           │       └ <function run at 0x7f17a606bdc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f17a2250b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f17a59d00d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f17a59d0040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f17a59d1b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f17a5a06820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f17a21a4f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f17a21dc1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f17a21a4f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f17a21dcfa0>
          └ <fastapi.applications.FastAPI object at 0x7f17a21dc1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f17a221b940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f17a21dcf40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f17a21dcfa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f17a221b940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f17a21dcf10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f17a21dcf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f17a21dceb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f17a21dcf10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f17a21dc220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f17a21dceb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f17a4c74280>
          └ <fastapi.routing.APIRoute object at 0x7f17a21d29a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f17a21d39d0>
          └ <fastapi.routing.APIRoute object at 0x7f17a21d29a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f17a217e040>
                     └ <function get_request_handler.<locals>.app at 0x7f17a21d3940>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f17a4c63160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>, 'page': 0, 'per_page': 10}
                 │         └ <function get_cities at 0x7f17a21d38b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f17a21d2820>

  File "/app/fastapi_service/main.py", line 88, in get_cities
    cities = await _services.get_cities(page=page, per_page=per_page, db=db)
                   │         │               │              │            └ <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>
                   │         │               │              └ 10
                   │         │               └ 0
                   │         └ <function get_cities at 0x7f17a22e7670>
                   └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 31, in get_cities
    cities = db.query(_models.City).all()
             │  │     │       └ <class 'models.City'>
             │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
             │  └ <function Session.query at 0x7f17a3becc10>
             └ <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2772, in all
    return self._iter().all()
           │    └ <function Query._iter at 0x7f17a3c0f0d0>
           └ <sqlalchemy.orm.query.Query object at 0x7f17a217ea60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f17a3bec5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>
             └ <sqlalchemy.orm.query.Query object at 0x7f17a217ea60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f17a214c0a0>
             │    └ <function Connection._execute_20 at 0x7f17a414af70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f17a214c0a0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f17a414adc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f17a414c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f17a414c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f17a499b040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f17a5642c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f17a3b7b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f17a2169400; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:28:50.801180+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (139739549534016):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f17a5642c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f17a3b7b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f17a2169400; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7f17a61699d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7f17a4a98e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7f17a4a98940>
    └ <uvicorn.server.Server object at 0x7f17a21a4160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f17a4a989d0>
           │       │   └ <uvicorn.server.Server object at 0x7f17a21a4160>
           │       └ <function run at 0x7f17a606bdc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f17a2250b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7f17a59d00d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f17a59d0040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f17a59d1b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f17a5a06820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7f17a2130340>(<Future finis...7f17a21307f0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f17a21a4f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f17a21dc1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f17a21a4f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f17a21dcfa0>
          └ <fastapi.applications.FastAPI object at 0x7f17a21dc1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f17a221b940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f17a21dcf40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f17a21dcfa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f17a221b940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f17a21dcf10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f17a21dcf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f17a21dceb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f17a21dcf10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7f17a21dc220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7f17a21dceb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7f17a4c74280>
          └ <fastapi.routing.APIRoute object at 0x7f17a21d29a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7f17a21c8c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7f17a217e880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7f17a21d39d0>
          └ <fastapi.routing.APIRoute object at 0x7f17a21d29a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f17a217e040>
                     └ <function get_request_handler.<locals>.app at 0x7f17a21d3940>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f17a4c63160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>, 'page': 0, 'per_page': 10}
                 │         └ <function get_cities at 0x7f17a21d38b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f17a21d2820>

  File "/app/fastapi_service/main.py", line 88, in get_cities
    cities = await _services.get_cities(page=page, per_page=per_page, db=db)
                   │         │               │              │            └ <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>
                   │         │               │              └ 10
                   │         │               └ 0
                   │         └ <function get_cities at 0x7f17a22e7670>
                   └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 31, in get_cities
    cities = db.query(_models.City).all()
             │  │     │       └ <class 'models.City'>
             │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
             │  └ <function Session.query at 0x7f17a3becc10>
             └ <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2772, in all
    return self._iter().all()
           │    └ <function Query._iter at 0x7f17a3c0f0d0>
           └ <sqlalchemy.orm.query.Query object at 0x7f17a217ea60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7f17a3bec5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7f17a21307f0>
             └ <sqlalchemy.orm.query.Query object at 0x7f17a217ea60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7f17a214c0a0>
             │    └ <function Connection._execute_20 at 0x7f17a414af70>
             └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f17a214c0a0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f17a414adc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f17a414c0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f17a414c280>
    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7f17a499b040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f17a5642c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f17a3b7b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7f17a2147100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f17a2169400; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:30:50.267378+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140339173066560):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6fa400; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fa3426f99d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fa341028e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fa341028940>
    └ <uvicorn.server.Server object at 0x7fa33e734160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fa3410289d0>
           │       │   └ <uvicorn.server.Server object at 0x7fa33e734160>
           │       └ <function run at 0x7fa3425fbdc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fa33e7e0b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fa341f600d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fa341f60040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fa341f61b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fa341f96820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
          └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e7ab940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e7ab940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fa33e76c220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fa341203280>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7629a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fa33e7639d0>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7629a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fa33e70f040>
                     └ <function get_request_handler.<locals>.app at 0x7fa33e763940>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fa3411f3160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>, 'page': 0, 'per_page': 10}
                 │         └ <function get_cities at 0x7fa33e7638b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fa33e762820>

  File "/app/fastapi_service/main.py", line 88, in get_cities
    cities = await _services.get_cities(page=page, per_page=per_page, db=db)
                   │         │               │              │            └ <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>
                   │         │               │              └ 10
                   │         │               └ 0
                   │         └ <function get_cities at 0x7fa33e877670>
                   └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 31, in get_cities
    cities = db.query(_models.City).all()
             │  │     │       └ <class 'models.City'>
             │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
             │  └ <function Session.query at 0x7fa34017cc10>
             └ <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2772, in all
    return self._iter().all()
           │    └ <function Query._iter at 0x7fa34019f0d0>
           └ <sqlalchemy.orm.query.Query object at 0x7fa33e70fa60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa34017c5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>
             └ <sqlalchemy.orm.query.Query object at 0x7fa33e70fa60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7fa33e6dc0a0>
             │    └ <function Connection._execute_20 at 0x7fa3406daf70>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7fa33e6dc0a0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa3406dadc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa3406dc0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa3406dc280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa340f2b040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6fa400; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:30:50.267378+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140339173066560):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6fa400; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fa3426f99d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fa341028e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fa341028940>
    └ <uvicorn.server.Server object at 0x7fa33e734160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fa3410289d0>
           │       │   └ <uvicorn.server.Server object at 0x7fa33e734160>
           │       └ <function run at 0x7fa3425fbdc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fa33e7e0b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fa341f600d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fa341f60040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fa341f61b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fa341f96820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33e6c0340>(<Future finis...7fa33e6c07f0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
          └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e7ab940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 84, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e7ab940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fa33e76c220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fa341203280>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7629a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e758c10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33e70f880>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fa33e7639d0>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7629a0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fa33e70f040>
                     └ <function get_request_handler.<locals>.app at 0x7fa33e763940>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fa3411f3160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>, 'page': 0, 'per_page': 10}
                 │         └ <function get_cities at 0x7fa33e7638b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fa33e762820>

  File "/app/fastapi_service/main.py", line 88, in get_cities
    cities = await _services.get_cities(page=page, per_page=per_page, db=db)
                   │         │               │              │            └ <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>
                   │         │               │              └ 10
                   │         │               └ 0
                   │         └ <function get_cities at 0x7fa33e877670>
                   └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 31, in get_cities
    cities = db.query(_models.City).all()
             │  │     │       └ <class 'models.City'>
             │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
             │  └ <function Session.query at 0x7fa34017cc10>
             └ <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2772, in all
    return self._iter().all()
           │    └ <function Query._iter at 0x7fa34019f0d0>
           └ <sqlalchemy.orm.query.Query object at 0x7fa33e70fa60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa34017c5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa33e6c07f0>
             └ <sqlalchemy.orm.query.Query object at 0x7fa33e70fa60>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7fa33e6dc0a0>
             │    └ <function Connection._execute_20 at 0x7fa3406daf70>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7fa33e6dc0a0>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa3406dadc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa3406dc0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa3406dc280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa340f2b040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33e6d7100>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6fa400; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:33:25.795051+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140339173066560):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6faa90; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fa3426f99d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fa341028e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fa341028940>
    └ <uvicorn.server.Server object at 0x7fa33e734160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fa3410289d0>
           │       │   └ <uvicorn.server.Server object at 0x7fa33e734160>
           │       └ <function run at 0x7fa3425fbdc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fa33e7e0b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fa341f600d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fa341f60040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fa341f61b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fa341f96820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
          └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e721940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e721940>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fa3410f9160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fa33e76c220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fa341203280>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7603d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fa33e763550>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7603d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fa33dc627c0>
                     └ <function get_request_handler.<locals>.app at 0x7fa33e7634c0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fa3411f3160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>, 'city_info': _BaseCity(country='', region='', city_name='st...
                 │         └ <function add_city at 0x7fa33e763430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fa33e7603a0>

  File "/app/fastapi_service/main.py", line 58, in add_city
    city = await _services.get_city_by_name(db=db, city_name=city_info.city_name)
                 │         │                   │             │         └ 'string'
                 │         │                   │             └ _BaseCity(country='', region='', city_name='string')
                 │         │                   └ <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>
                 │         └ <function get_city_by_name at 0x7fa33e877790>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 43, in get_city_by_name
    city = db.query(_models.City).filter(_models.City.city_name == city_name).first()
           │  │     │       │            │       │    │            └ 'string'
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7fa33e81a720>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7fa34017cc10>
           └ <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7fa34019b550>
           └ <sqlalchemy.orm.query.Query object at 0x7fa33dc624c0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa34017c5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>
             └ <sqlalchemy.orm.query.Query object at 0x7fa34086a070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7fa33dc62a00>
             │    └ <function Connection._execute_20 at 0x7fa3406daf70>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7fa33dc62a00>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa3406dadc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa3406dc0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa3406dc280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa340f2b040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6faa90; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.city_name = %(city_name_1)s 
 LIMIT %(param_1)s]
[parameters: {'city_name_1': 'string', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:33:25.795051+0000: ERROR|	 An error has been caught in function 'run_endpoint_function', process 'MainProcess' (1), thread 'MainThread' (140339173066560):
Traceback (most recent call last):

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6faa90; closed: -1>

psycopg2.errors.UndefinedColumn: column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/app/fastapi_service/main.py", line 95, in <module>
    _uvicorn.run("main:app", host="0.0.0.0", port=_os.getenv("PORT", 8002))
    │        │                                    │   └ <function getenv at 0x7fa3426f99d0>
    │        │                                    └ <module 'os' from '/usr/local/lib/python3.9/os.py'>
    │        └ <function run at 0x7fa341028e50>
    └ <module 'uvicorn' from '/usr/local/lib/python3.9/site-packages/uvicorn/__init__.py'>

  File "/usr/local/lib/python3.9/site-packages/uvicorn/main.py", line 576, in run
    server.run()
    │      └ <function Server.run at 0x7fa341028940>
    └ <uvicorn.server.Server object at 0x7fa33e734160>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/server.py", line 60, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fa3410289d0>
           │       │   └ <uvicorn.server.Server object at 0x7fa33e734160>
           │       └ <function run at 0x7fa3425fbdc0>
           └ <module 'asyncio' from '/usr/local/lib/python3.9/asyncio/__init__.py'>
  File "/usr/local/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7fa33e7e0b40>
           │    └ <function BaseEventLoop.run_until_complete at 0x7fa341f600d0>
           └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7fa341f60040>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7fa341f61b80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7fa341f96820>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
  File "/usr/local/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x7fa33dc62460>(<Future finis...7fa33e70f0a0>>)>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa33e734f40>
  File "/usr/local/lib/python3.9/site-packages/fastapi/applications.py", line 270, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
  File "/usr/local/lib/python3.9/site-packages/starlette/applications.py", line 124, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
          └ <fastapi.applications.FastAPI object at 0x7fa33e76c1c0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e721940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa33e76cfa0>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 92, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'user-agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/10...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa33e721940>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function CORSMiddleware.simple_response at 0x7fa3410f9160>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/cors.py", line 147, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa33e76cf40>
  File "/usr/local/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 64, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa33e76cf10>
  File "/usr/local/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7fa33e76c220>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7fa33e76ceb0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 680, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │     └ <function Route.handle at 0x7fa341203280>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7603d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 275, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x7fa33e6eb790>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7fa33dc627f0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.21.0.3', 8002), 'c...
          │    └ <function request_response.<locals>.app at 0x7fa33e763550>
          └ <fastapi.routing.APIRoute object at 0x7fa33e7603d0>
  File "/usr/local/lib/python3.9/site-packages/starlette/routing.py", line 65, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fa33dc627c0>
                     └ <function get_request_handler.<locals>.app at 0x7fa33e7634c0>
  File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 231, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fa3411f3160>
> File "/usr/local/lib/python3.9/site-packages/fastapi/routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>, 'city_info': _BaseCity(country='', region='', city_name='st...
                 │         └ <function add_city at 0x7fa33e763430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7fa33e7603a0>

  File "/app/fastapi_service/main.py", line 58, in add_city
    city = await _services.get_city_by_name(db=db, city_name=city_info.city_name)
                 │         │                   │             │         └ 'string'
                 │         │                   │             └ _BaseCity(country='', region='', city_name='string')
                 │         │                   └ <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>
                 │         └ <function get_city_by_name at 0x7fa33e877790>
                 └ <module 'services' from '/app/fastapi_service/services.py'>

  File "/app/fastapi_service/services.py", line 43, in get_city_by_name
    city = db.query(_models.City).filter(_models.City.city_name == city_name).first()
           │  │     │       │            │       │    │            └ 'string'
           │  │     │       │            │       │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7fa33e81a720>
           │  │     │       │            │       └ <class 'models.City'>
           │  │     │       │            └ <module 'models' from '/app/fastapi_service/models.py'>
           │  │     │       └ <class 'models.City'>
           │  │     └ <module 'models' from '/app/fastapi_service/models.py'>
           │  └ <function Session.query at 0x7fa34017cc10>
           └ <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>

  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2823, in first
    return self.limit(1)._iter().first()
           │    └ <function Query.limit at 0x7fa34019b550>
           └ <sqlalchemy.orm.query.Query object at 0x7fa33dc624c0>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2907, in _iter
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa34017c5e0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa33e70f0a0>
             └ <sqlalchemy.orm.query.Query object at 0x7fa34086a070>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.selectable.Select object at 0x7fa33dc62a00>
             │    └ <function Connection._execute_20 at 0x7fa3406daf70>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'_sa_orm_load_options': default_load_options(_legacy_uniquing=True), '_result_disable_adapt_to_context': True,...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7fa33dc62a00>>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa3406dadc0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa3406dc0d0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa3406dc280>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa340f2b040>
    └ <module 'sqlalchemy.util' from '/usr/local/lib/python3.9/site-packages/sqlalchemy/util/__init__.py'>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa341bd2c10>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7fa34010b400>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa33dc62b20>
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'city_name_1': 'string', 'param_1': 1}
    │      │       └ 'SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name \nFROM...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fa33e6faa90; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column city.city_name does not exist
LINE 1: ...ntry AS city_country, city.region AS city_region, city.city_...
                                                             ^

[SQL: SELECT city.id AS city_id, city.country AS city_country, city.region AS city_region, city.city_name AS city_city_name 
FROM city 
WHERE city.city_name = %(city_name_1)s 
 LIMIT %(param_1)s]
[parameters: {'city_name_1': 'string', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-10-12T16:55:50.505461+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T16:55:50.505461+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:15:41.372371+0000: ERROR|	 GET /api/city/12/ 404 NOT FOUND
2022-10-12T17:15:41.372371+0000: ERROR|	 GET /api/city/12/ 404 NOT FOUND
2022-10-12T17:16:06.396558+0000: INFO|	 POST /api/city/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T17:16:06.396558+0000: INFO|	 POST /api/city/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T17:16:30.156527+0000: INFO|	 GET /api/cities/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T17:16:30.156527+0000: INFO|	 GET /api/cities/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T17:16:54.720157+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:16:54.720157+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:17:18.879557+0000: ERROR|	 POST /api/city/ { city_name : Санкт Петербург, country : , region : Ленобласть } 409 ALREADY EXISTS
2022-10-12T17:17:18.879557+0000: ERROR|	 POST /api/city/ { city_name : Санкт Петербург, country : , region : Ленобласть } 409 ALREADY EXISTS
2022-10-12T17:17:32.732518+0000: INFO|	 POST /api/city/ { city_name : Магадан, country : Россия, region : Ленобласть } 200 OK
2022-10-12T17:17:32.732518+0000: INFO|	 POST /api/city/ { city_name : Магадан, country : Россия, region : Ленобласть } 200 OK
2022-10-12T17:17:39.829150+0000: INFO|	 POST /api/city/ { city_name : Курск, country : Россия, region : Ленобласть } 200 OK
2022-10-12T17:17:39.829150+0000: INFO|	 POST /api/city/ { city_name : Курск, country : Россия, region : Ленобласть } 200 OK
2022-10-12T17:17:44.333584+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:17:44.333584+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:19:10.483673+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:19:10.483673+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T17:19:30.150754+0000: INFO|	 GET /api/cities/ { city_name : string, country : Россия, region :  } 200 OK
2022-10-12T17:19:30.150754+0000: INFO|	 GET /api/cities/ { city_name : string, country : Россия, region :  } 200 OK
2022-10-12T17:19:53.737436+0000: INFO|	 GET /api/cities/ { city_name : , country : Россия, region :  } 200 OK
2022-10-12T17:19:53.737436+0000: INFO|	 GET /api/cities/ { city_name : , country : Россия, region :  } 200 OK
2022-10-12T17:20:22.197443+0000: INFO|	 GET /api/cities/ { city_name : , country : Россия, region : Ленобласть } 200 OK
2022-10-12T17:20:22.197443+0000: INFO|	 GET /api/cities/ { city_name : , country : Россия, region : Ленобласть } 200 OK
2022-10-12T17:20:30.075341+0000: INFO|	 GET /api/cities/ { city_name : , country : , region : Ленобласть } 200 OK
2022-10-12T17:20:30.075341+0000: INFO|	 GET /api/cities/ { city_name : , country : , region : Ленобласть } 200 OK
2022-10-12T17:20:38.815553+0000: INFO|	 GET /api/cities/ { city_name : Курск, country : , region :  } 200 OK
2022-10-12T17:20:38.815553+0000: INFO|	 GET /api/cities/ { city_name : Курск, country : , region :  } 200 OK
2022-10-12T17:20:45.701301+0000: INFO|	 GET /api/cities/ { city_name : Курск, country : , region :  } 200 OK
2022-10-12T17:20:45.701301+0000: INFO|	 GET /api/cities/ { city_name : Курск, country : , region :  } 200 OK
2022-10-12T20:12:18.195135+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T20:12:18.195135+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T20:12:33.171063+0000: INFO|	 GET /api/cities/ { city_name : string, country : , region :  } 200 OK
2022-10-12T20:12:33.171063+0000: INFO|	 GET /api/cities/ { city_name : string, country : , region :  } 200 OK
2022-10-12T20:12:44.395528+0000: INFO|	 GET /api/cities/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T20:12:44.395528+0000: INFO|	 GET /api/cities/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T20:12:49.638305+0000: INFO|	 GET /api/cities/ { city_name : санкт Петербург, country : , region :  } 200 OK
2022-10-12T20:12:49.638305+0000: INFO|	 GET /api/cities/ { city_name : санкт Петербург, country : , region :  } 200 OK
2022-10-12T20:12:54.349041+0000: INFO|	 GET /api/cities/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T20:12:54.349041+0000: INFO|	 GET /api/cities/ { city_name : Санкт Петербург, country : , region :  } 200 OK
2022-10-12T20:13:28.678589+0000: INFO|	 POST /api/city/ { city_name : Санкт Петербург, country : Россия, region : Ленобласть } 200 OK
2022-10-12T20:13:28.678589+0000: INFO|	 POST /api/city/ { city_name : Санкт Петербург, country : Россия, region : Ленобласть } 200 OK
2022-10-12T20:13:34.866739+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-10-12T20:13:34.866739+0000: INFO|	 GET /api/city/?page=0&per_page=10/ 200 OK
2022-11-05T22:19:21.613319+0000: INFO|	 GET /api/cities?page=0&per_page=10/ 200 OK
2022-11-05T22:19:21.613319+0000: INFO|	 GET /api/cities?page=0&per_page=10/ 200 OK
